package com.apps10x.weatherapp.data.api

import com.apps10x.weatherapp.data.model.ForecastData
import kotlinx.coroutines.test.runTest
import okhttp3.mockwebserver.MockResponse
import okhttp3.mockwebserver.MockWebServer
import org.junit.After
import org.junit.Assert
import org.junit.Before
import org.junit.Test
import retrofit2.Retrofit
import retrofit2.converter.gson.GsonConverterFactory

class ApiServiceTest {


    lateinit var mockWebServer: MockWebServer
    lateinit var apiService: ApiService

    @Before
    fun setUp(){
        mockWebServer = MockWebServer()
        apiService = Retrofit.Builder()
            .baseUrl(mockWebServer.url("/"))
            .addConverterFactory(GsonConverterFactory.create())
            .build()
            .create(ApiService::class.java)

    }

    @Test
    fun testGetForecast() = runTest{
        val mockResponse = MockResponse()
        val forecastJson = "{\"cod\":\"200\",\"message\":0,\"cnt\":40,\"list\":[{\"dt\":1676484000,\"main\":{\"temp\":294.95,\"feels_like\":294.39,\"temp_min\":292.72,\"temp_max\":294.95,\"pressure\":1017,\"sea_level\":1017,\"grnd_level\":912,\"humidity\":46,\"temp_kf\":2.23},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01n\"}],\"clouds\":{\"all\":0},\"wind\":{\"speed\":4.27,\"deg\":95,\"gust\":8.36},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2023-02-15 18:00:00\"},{\"dt\":1676494800,\"main\":{\"temp\":293.59,\"feels_like\":293.02,\"temp_min\":290.87,\"temp_max\":293.59,\"pressure\":1016,\"sea_level\":1016,\"grnd_level\":910,\"humidity\":51,\"temp_kf\":2.72},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01n\"}],\"clouds\":{\"all\":0},\"wind\":{\"speed\":3.25,\"deg\":92,\"gust\":4.93},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2023-02-15 21:00:00\"},{\"dt\":1676505600,\"main\":{\"temp\":291.72,\"feels_like\":291.04,\"temp_min\":290.1,\"temp_max\":291.72,\"pressure\":1014,\"sea_level\":1014,\"grnd_level\":909,\"humidity\":54,\"temp_kf\":1.62},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01n\"}],\"clouds\":{\"all\":1},\"wind\":{\"speed\":2.87,\"deg\":67,\"gust\":3.72},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2023-02-16 00:00:00\"},{\"dt\":1676516400,\"main\":{\"temp\":295.27,\"feels_like\":294.5,\"temp_min\":295.27,\"temp_max\":295.27,\"pressure\":1014,\"sea_level\":1014,\"grnd_level\":913,\"humidity\":37,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01d\"}],\"clouds\":{\"all\":7},\"wind\":{\"speed\":3.94,\"deg\":63,\"gust\":7.57},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2023-02-16 03:00:00\"},{\"dt\":1676527200,\"main\":{\"temp\":302.21,\"feels_like\":300.61,\"temp_min\":302.21,\"temp_max\":302.21,\"pressure\":1014,\"sea_level\":1014,\"grnd_level\":915,\"humidity\":18,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01d\"}],\"clouds\":{\"all\":8},\"wind\":{\"speed\":6.14,\"deg\":72,\"gust\":7.81},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2023-02-16 06:00:00\"},{\"dt\":1676538000,\"main\":{\"temp\":304.38,\"feels_like\":302.28,\"temp_min\":304.38,\"temp_max\":304.38,\"pressure\":1010,\"sea_level\":1010,\"grnd_level\":912,\"humidity\":14,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01d\"}],\"clouds\":{\"all\":8},\"wind\":{\"speed\":6.44,\"deg\":73,\"gust\":7.28},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2023-02-16 09:00:00\"},{\"dt\":1676548800,\"main\":{\"temp\":301.99,\"feels_like\":300.47,\"temp_min\":301.99,\"temp_max\":301.99,\"pressure\":1010,\"sea_level\":1010,\"grnd_level\":911,\"humidity\":19,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01d\"}],\"clouds\":{\"all\":7},\"wind\":{\"speed\":5.52,\"deg\":91,\"gust\":6.29},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2023-02-16 12:00:00\"},{\"dt\":1676559600,\"main\":{\"temp\":295.61,\"feels_like\":294.85,\"temp_min\":295.61,\"temp_max\":295.61,\"pressure\":1014,\"sea_level\":1014,\"grnd_level\":913,\"humidity\":36,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01n\"}],\"clouds\":{\"all\":6},\"wind\":{\"speed\":4.55,\"deg\":103,\"gust\":9.14},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2023-02-16 15:00:00\"},{\"dt\":1676570400,\"main\":{\"temp\":292.66,\"feels_like\":292.1,\"temp_min\":292.66,\"temp_max\":292.66,\"pressure\":1015,\"sea_level\":1015,\"grnd_level\":913,\"humidity\":55,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01n\"}],\"clouds\":{\"all\":9},\"wind\":{\"speed\":4.23,\"deg\":105,\"gust\":8.04},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2023-02-16 18:00:00\"},{\"dt\":1676581200,\"main\":{\"temp\":291.11,\"feels_like\":290.58,\"temp_min\":291.11,\"temp_max\":291.11,\"pressure\":1013,\"sea_level\":1013,\"grnd_level\":911,\"humidity\":62,\"temp_kf\":0},\"weather\":[{\"id\":801,\"main\":\"Clouds\",\"description\":\"few clouds\",\"icon\":\"02n\"}],\"clouds\":{\"all\":20},\"wind\":{\"speed\":3.33,\"deg\":94,\"gust\":5.34},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2023-02-16 21:00:00\"},{\"dt\":1676592000,\"main\":{\"temp\":290.07,\"feels_like\":289.46,\"temp_min\":290.07,\"temp_max\":290.07,\"pressure\":1014,\"sea_level\":1014,\"grnd_level\":911,\"humidity\":63,\"temp_kf\":0},\"weather\":[{\"id\":802,\"main\":\"Clouds\",\"description\":\"scattered clouds\",\"icon\":\"03n\"}],\"clouds\":{\"all\":40},\"wind\":{\"speed\":2.47,\"deg\":102,\"gust\":3.06},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2023-02-17 00:00:00\"},{\"dt\":1676602800,\"main\":{\"temp\":295.36,\"feels_like\":294.55,\"temp_min\":295.36,\"temp_max\":295.36,\"pressure\":1015,\"sea_level\":1015,\"grnd_level\":914,\"humidity\":35,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01d\"}],\"clouds\":{\"all\":5},\"wind\":{\"speed\":2.58,\"deg\":90,\"gust\":4.25},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2023-02-17 03:00:00\"},{\"dt\":1676613600,\"main\":{\"temp\":302.5,\"feels_like\":300.85,\"temp_min\":302.5,\"temp_max\":302.5,\"pressure\":1014,\"sea_level\":1014,\"grnd_level\":915,\"humidity\":19,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01d\"}],\"clouds\":{\"all\":4},\"wind\":{\"speed\":6,\"deg\":74,\"gust\":8},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2023-02-17 06:00:00\"},{\"dt\":1676624400,\"main\":{\"temp\":304.38,\"feels_like\":302.29,\"temp_min\":304.38,\"temp_max\":304.38,\"pressure\":1010,\"sea_level\":1010,\"grnd_level\":912,\"humidity\":15,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01d\"}],\"clouds\":{\"all\":0},\"wind\":{\"speed\":5.9,\"deg\":84,\"gust\":6.74},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2023-02-17 09:00:00\"},{\"dt\":1676635200,\"main\":{\"temp\":302.33,\"feels_like\":300.7,\"temp_min\":302.33,\"temp_max\":302.33,\"pressure\":1010,\"sea_level\":1010,\"grnd_level\":912,\"humidity\":18,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01d\"}],\"clouds\":{\"all\":1},\"wind\":{\"speed\":5.49,\"deg\":97,\"gust\":5.98},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2023-02-17 12:00:00\"},{\"dt\":1676646000,\"main\":{\"temp\":296.07,\"feels_like\":295.23,\"temp_min\":296.07,\"temp_max\":296.07,\"pressure\":1014,\"sea_level\":1014,\"grnd_level\":913,\"humidity\":31,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01n\"}],\"clouds\":{\"all\":0},\"wind\":{\"speed\":4.03,\"deg\":105,\"gust\":8.06},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2023-02-17 15:00:00\"},{\"dt\":1676656800,\"main\":{\"temp\":293.5,\"feels_like\":292.77,\"temp_min\":293.5,\"temp_max\":293.5,\"pressure\":1015,\"sea_level\":1015,\"grnd_level\":913,\"humidity\":45,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01n\"}],\"clouds\":{\"all\":0},\"wind\":{\"speed\":3.59,\"deg\":108,\"gust\":6.5},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2023-02-17 18:00:00\"},{\"dt\":1676667600,\"main\":{\"temp\":291.91,\"feels_like\":291.28,\"temp_min\":291.91,\"temp_max\":291.91,\"pressure\":1013,\"sea_level\":1013,\"grnd_level\":911,\"humidity\":55,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01n\"}],\"clouds\":{\"all\":0},\"wind\":{\"speed\":2.93,\"deg\":105,\"gust\":3.77},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2023-02-17 21:00:00\"},{\"dt\":1676678400,\"main\":{\"temp\":290.85,\"feels_like\":290.24,\"temp_min\":290.85,\"temp_max\":290.85,\"pressure\":1013,\"sea_level\":1013,\"grnd_level\":910,\"humidity\":60,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01n\"}],\"clouds\":{\"all\":0},\"wind\":{\"speed\":2.68,\"deg\":105,\"gust\":3.28},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2023-02-18 00:00:00\"},{\"dt\":1676689200,\"main\":{\"temp\":295.16,\"feels_like\":294.57,\"temp_min\":295.16,\"temp_max\":295.16,\"pressure\":1015,\"sea_level\":1015,\"grnd_level\":914,\"humidity\":44,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01d\"}],\"clouds\":{\"all\":0},\"wind\":{\"speed\":2.31,\"deg\":115,\"gust\":3.26},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2023-02-18 03:00:00\"},{\"dt\":1676700000,\"main\":{\"temp\":302.17,\"feels_like\":300.63,\"temp_min\":302.17,\"temp_max\":302.17,\"pressure\":1014,\"sea_level\":1014,\"grnd_level\":915,\"humidity\":20,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01d\"}],\"clouds\":{\"all\":0},\"wind\":{\"speed\":4.04,\"deg\":75,\"gust\":5.84},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2023-02-18 06:00:00\"},{\"dt\":1676710800,\"main\":{\"temp\":304.53,\"feels_like\":302.49,\"temp_min\":304.53,\"temp_max\":304.53,\"pressure\":1010,\"sea_level\":1010,\"grnd_level\":912,\"humidity\":18,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01d\"}],\"clouds\":{\"all\":0},\"wind\":{\"speed\":4.5,\"deg\":74,\"gust\":4.86},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2023-02-18 09:00:00\"},{\"dt\":1676721600,\"main\":{\"temp\":303.01,\"feels_like\":301.28,\"temp_min\":303.01,\"temp_max\":303.01,\"pressure\":1010,\"sea_level\":1010,\"grnd_level\":911,\"humidity\":20,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01d\"}],\"clouds\":{\"all\":0},\"wind\":{\"speed\":4.85,\"deg\":88,\"gust\":4.71},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2023-02-18 12:00:00\"},{\"dt\":1676732400,\"main\":{\"temp\":296.74,\"feels_like\":295.94,\"temp_min\":296.74,\"temp_max\":296.74,\"pressure\":1013,\"sea_level\":1013,\"grnd_level\":913,\"humidity\":30,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01n\"}],\"clouds\":{\"all\":0},\"wind\":{\"speed\":5.22,\"deg\":110,\"gust\":10.23},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2023-02-18 15:00:00\"},{\"dt\":1676743200,\"main\":{\"temp\":294.1,\"feels_like\":293.35,\"temp_min\":294.1,\"temp_max\":294.1,\"pressure\":1014,\"sea_level\":1014,\"grnd_level\":913,\"humidity\":42,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01n\"}],\"clouds\":{\"all\":0},\"wind\":{\"speed\":3.69,\"deg\":115,\"gust\":7.29},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2023-02-18 18:00:00\"},{\"dt\":1676754000,\"main\":{\"temp\":292.14,\"feels_like\":291.45,\"temp_min\":292.14,\"temp_max\":292.14,\"pressure\":1013,\"sea_level\":1013,\"grnd_level\":911,\"humidity\":52,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01n\"}],\"clouds\":{\"all\":0},\"wind\":{\"speed\":2.51,\"deg\":127,\"gust\":3.27},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2023-02-18 21:00:00\"},{\"dt\":1676764800,\"main\":{\"temp\":290.92,\"feels_like\":290.37,\"temp_min\":290.92,\"temp_max\":290.92,\"pressure\":1014,\"sea_level\":1014,\"grnd_level\":911,\"humidity\":62,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01n\"}],\"clouds\":{\"all\":0},\"wind\":{\"speed\":2.73,\"deg\":128,\"gust\":3.45},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2023-02-19 00:00:00\"},{\"dt\":1676775600,\"main\":{\"temp\":294.41,\"feels_like\":293.92,\"temp_min\":294.41,\"temp_max\":294.41,\"pressure\":1016,\"sea_level\":1016,\"grnd_level\":914,\"humidity\":51,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01d\"}],\"clouds\":{\"all\":1},\"wind\":{\"speed\":2.63,\"deg\":147,\"gust\":3.5},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2023-02-19 03:00:00\"},{\"dt\":1676786400,\"main\":{\"temp\":301.33,\"feels_like\":300.21,\"temp_min\":301.33,\"temp_max\":301.33,\"pressure\":1014,\"sea_level\":1014,\"grnd_level\":915,\"humidity\":26,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01d\"}],\"clouds\":{\"all\":2},\"wind\":{\"speed\":3.28,\"deg\":105,\"gust\":5.14},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2023-02-19 06:00:00\"},{\"dt\":1676797200,\"main\":{\"temp\":303.95,\"feels_like\":302.02,\"temp_min\":303.95,\"temp_max\":303.95,\"pressure\":1010,\"sea_level\":1010,\"grnd_level\":912,\"humidity\":19,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01d\"}],\"clouds\":{\"all\":6},\"wind\":{\"speed\":4.12,\"deg\":101,\"gust\":4.17},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2023-02-19 09:00:00\"},{\"dt\":1676808000,\"main\":{\"temp\":302.53,\"feels_like\":300.87,\"temp_min\":302.53,\"temp_max\":302.53,\"pressure\":1010,\"sea_level\":1010,\"grnd_level\":912,\"humidity\":19,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01d\"}],\"clouds\":{\"all\":5},\"wind\":{\"speed\":4.69,\"deg\":109,\"gust\":3.73},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2023-02-19 12:00:00\"},{\"dt\":1676818800,\"main\":{\"temp\":296.73,\"feels_like\":295.95,\"temp_min\":296.73,\"temp_max\":296.73,\"pressure\":1014,\"sea_level\":1014,\"grnd_level\":913,\"humidity\":31,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01n\"}],\"clouds\":{\"all\":0},\"wind\":{\"speed\":4.97,\"deg\":114,\"gust\":9.93},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2023-02-19 15:00:00\"},{\"dt\":1676829600,\"main\":{\"temp\":293.7,\"feels_like\":293.17,\"temp_min\":293.7,\"temp_max\":293.7,\"pressure\":1015,\"sea_level\":1015,\"grnd_level\":913,\"humidity\":52,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01n\"}],\"clouds\":{\"all\":0},\"wind\":{\"speed\":4.66,\"deg\":98,\"gust\":8.98},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2023-02-19 18:00:00\"},{\"dt\":1676840400,\"main\":{\"temp\":291.65,\"feels_like\":291.38,\"temp_min\":291.65,\"temp_max\":291.65,\"pressure\":1013,\"sea_level\":1013,\"grnd_level\":911,\"humidity\":70,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01n\"}],\"clouds\":{\"all\":0},\"wind\":{\"speed\":3.17,\"deg\":107,\"gust\":5.12},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2023-02-19 21:00:00\"},{\"dt\":1676851200,\"main\":{\"temp\":290.43,\"feels_like\":290.2,\"temp_min\":290.43,\"temp_max\":290.43,\"pressure\":1014,\"sea_level\":1014,\"grnd_level\":911,\"humidity\":76,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01n\"}],\"clouds\":{\"all\":0},\"wind\":{\"speed\":1.96,\"deg\":133,\"gust\":2.32},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2023-02-20 00:00:00\"},{\"dt\":1676862000,\"main\":{\"temp\":294.64,\"feels_like\":294.31,\"temp_min\":294.64,\"temp_max\":294.64,\"pressure\":1016,\"sea_level\":1016,\"grnd_level\":914,\"humidity\":56,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01d\"}],\"clouds\":{\"all\":0},\"wind\":{\"speed\":1.85,\"deg\":140,\"gust\":2.12},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2023-02-20 03:00:00\"},{\"dt\":1676872800,\"main\":{\"temp\":301.83,\"feels_like\":300.43,\"temp_min\":301.83,\"temp_max\":301.83,\"pressure\":1014,\"sea_level\":1014,\"grnd_level\":915,\"humidity\":22,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01d\"}],\"clouds\":{\"all\":0},\"wind\":{\"speed\":3.59,\"deg\":78,\"gust\":5.01},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2023-02-20 06:00:00\"},{\"dt\":1676883600,\"main\":{\"temp\":304.59,\"feels_like\":302.46,\"temp_min\":304.59,\"temp_max\":304.59,\"pressure\":1010,\"sea_level\":1010,\"grnd_level\":912,\"humidity\":15,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01d\"}],\"clouds\":{\"all\":0},\"wind\":{\"speed\":4.64,\"deg\":91,\"gust\":5.15},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2023-02-20 09:00:00\"},{\"dt\":1676894400,\"main\":{\"temp\":302.84,\"feels_like\":301.11,\"temp_min\":302.84,\"temp_max\":302.84,\"pressure\":1010,\"sea_level\":1010,\"grnd_level\":912,\"humidity\":19,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01d\"}],\"clouds\":{\"all\":0},\"wind\":{\"speed\":5.29,\"deg\":94,\"gust\":4.69},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"d\"},\"dt_txt\":\"2023-02-20 12:00:00\"},{\"dt\":1676905200,\"main\":{\"temp\":297.33,\"feels_like\":296.72,\"temp_min\":297.33,\"temp_max\":297.33,\"pressure\":1014,\"sea_level\":1014,\"grnd_level\":913,\"humidity\":35,\"temp_kf\":0},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01n\"}],\"clouds\":{\"all\":0},\"wind\":{\"speed\":4.75,\"deg\":112,\"gust\":9.29},\"visibility\":10000,\"pop\":0,\"sys\":{\"pod\":\"n\"},\"dt_txt\":\"2023-02-20 15:00:00\"}],\"city\":{\"id\":1277333,\"name\":\"Bengaluru\",\"coord\":{\"lat\":12.9762,\"lon\":77.6033},\"country\":\"IN\",\"population\":5104047,\"timezone\":19800,\"sunrise\":1676423546,\"sunset\":1676465719}}"
        mockResponse.setBody(forecastJson)
        mockWebServer.enqueue(mockResponse)

        val forecastData = apiService.getForecast()
        mockWebServer.takeRequest()

        Assert.assertEquals("200",forecastData.cod)
        Assert.assertEquals(0,forecastData.message)
        Assert.assertEquals(40,forecastData.cnt)
    }

    @Test
    fun testGetWeather() = runTest{
        val mockResponse = MockResponse()
        val weatherJson = "{\"coord\":{\"lon\":77.6033,\"lat\":12.9762},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01n\"}],\"base\":\"stations\",\"main\":{\"temp\":292.05,\"feels_like\":291.43,\"temp_min\":292.05,\"temp_max\":292.05,\"pressure\":1014,\"humidity\":55,\"sea_level\":1014,\"grnd_level\":911},\"visibility\":10000,\"wind\":{\"speed\":3.31,\"deg\":92,\"gust\":5.14},\"clouds\":{\"all\":0},\"dt\":1676490848,\"sys\":{\"type\":1,\"id\":9208,\"country\":\"IN\",\"sunrise\":1676509924,\"sunset\":1676552136},\"timezone\":19800,\"id\":1277333,\"name\":\"Bengaluru\",\"cod\":200}"
        mockResponse.setBody(weatherJson)
        mockWebServer.enqueue(mockResponse)

        val weatherData = apiService.getWeather()
        mockWebServer.takeRequest()

        Assert.assertEquals(800,weatherData.weather[0].id)
        Assert.assertEquals("Clear",weatherData.weather[0].main)
        Assert.assertEquals(200,weatherData.cod)
    }

    @After
    fun tearDown(){
        mockWebServer.shutdown()
    }


}